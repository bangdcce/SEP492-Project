// --- NODES DEFINITION ---

// 1. Authentication (UC-03)
LoginPage [shape: rectangle, label: "Login "]
BrokerDashboard [shape: rectangle, label: "Broker Dashboard"]

// 2. Profile Management (UC-04, UC-05, UC-06, UC-07, UC-08)
ProfileScreen [shape: rectangle, label: "My Profile "]
EditProfileModal [shape: oval, label: "Edit Profile "]
FeedbackListModal [shape: oval, label: "View Others Feedback "]
ReportFeedbackModal [shape: oval, label: "Report Feedback "]
DeleteAccountModal [shape: oval, label: "Delete Account Confirmation"]

// 3. KYC (Check KYC Status, Register KYC)
KycStatusScreen [shape: rectangle, label: "KYC Status "]
RegisterKycScreen [shape: rectangle, label: "Register KYC Form"]

// 4. Requests & Invitations (UC-51, UC-52, UC-34, UC-13, UC-14)
InvitationListScreen [shape: rectangle, label: "Request Invitations List"]
InvitationDetailModal [shape: oval, label: "Invitation Detail "]
RequestListScreen [shape: rectangle, label: "Assigned Requests List"] // /project-requests
RequestDetailScreen [shape: rectangle, label: "Request Detail "] // /project-requests/:id
DiscussionModal [shape: oval, label: "Discussion/Chat "]

// 5. Specs & Contract (UC-22, UC-23, UC-17, UC-18, UC-99, UC-100)
CreateSpecScreen [shape: rectangle, label: "Create Project Spec "] // /project-requests/:id/create-spec
SpecDetailModal [shape: oval, label: "Spec Detail "]
ContractListScreen [shape: rectangle, label: "Contracts List "] // /broker/contracts
ContractScreen [shape: rectangle, label: "Contract Detail View"] // /broker/contracts/:id
FinalizeContractModal [shape: oval, label: "Finalize Contract "]

// 6. Projects & Execution (UC-09, UC-55, UC-29, UC-53, UC-54)
ProjectListScreen [shape: rectangle, label: "My Projects List"] // /broker/projects
ProjectWorkspaceScreen [shape: rectangle, label: "Project Workspace"] // /broker/workspace
KanbanBoardScreen [shape: rectangle, label: "Kanban Board"]
MilestoneListScreen [shape: rectangle, label: "Milestones List"]
MilestoneDetailModal [shape: oval, label: "Milestone Detail "]
CurrentProgressScreen [shape: rectangle, label: "Current Progress "]
CancelProjectModal [shape: oval, label: "Cancel Project "]
SubmissionModal [shape: oval, label: "Add Evidence/Submit "]

// 7. Subscription (View, Register, Cancel)
SubscriptionScreen [shape: rectangle, label: "Subscription Plans "]
RegisterSubModal [shape: oval, label: "Register Subscription "]
CancelSubModal [shape: oval, label: "Cancel Subscription "]

// 8. Disputes (UC-11, UC-40, UC-56, UC-57, UC-165)
DisputeListScreen [shape: rectangle, label: "Active Disputes List"]
CreateDisputeScreen [shape: rectangle, label: "Create Dispute "]
DisputeInfoScreen [shape: rectangle, label: "Dispute Information "]
AddEvidenceModal [shape: oval, label: "Add Evidence "]
ReportDisputeModal [shape: oval, label: "Report Dispute "]

// 9. Financials (UC-12, UC-41, UC-42, UC-58)
WalletScreen [shape: rectangle, label: "My Wallet "]
PaymentMethodModal [shape: oval, label: "Choose Payment Method "]
CashoutListScreen [shape: rectangle, label: "Cashout History List"]
CashoutModal [shape: oval, label: "Request Cashout "]

// --- FLOW CONNECTIONS ---

// 1. Auth & Dashboard
LoginPage > BrokerDashboard: Login Success

// 2. Dashboard Navigation
BrokerDashboard > ProfileScreen: Click 'My Profile'
BrokerDashboard > KycStatusScreen: Click 'KYC Status'
BrokerDashboard > InvitationListScreen: Click 'Invitations'
BrokerDashboard > RequestListScreen: Click 'Project Requests'
BrokerDashboard > ProjectListScreen: Click 'My Projects'
BrokerDashboard > ContractListScreen: Click 'Contracts'
BrokerDashboard > SubscriptionScreen: Click 'Subscription'
BrokerDashboard > DisputeListScreen: Click 'Disputes'
BrokerDashboard > WalletScreen: Click 'My Wallet'

// 3. Profile Flows
ProfileScreen > EditProfileModal: Click 'Edit Profile'
EditProfileModal > ProfileScreen: Save Changes
ProfileScreen > FeedbackListModal: View 'Others Feedback'
FeedbackListModal > ReportFeedbackModal: Click 'Report'
ProfileScreen > DeleteAccountModal: Click 'Delete Account'

// 4. KYC Flows
KycStatusScreen > RegisterKycScreen: Click 'Register KYC'
RegisterKycScreen > KycStatusScreen: Submit KYC Form

// 5. Request & Invitation Flows
InvitationListScreen > InvitationDetailModal: Click 'View Detail'
InvitationDetailModal > InvitationListScreen: Accept/Deny Invitation
RequestListScreen > RequestDetailScreen: Select Request
RequestDetailScreen > CreateSpecScreen: Click 'Create Spec'
RequestDetailScreen > DiscussionModal: Click 'Discussion'
RequestDetailScreen > SpecDetailModal: Click 'View Specs'

// 6. Contract Flows
ContractListScreen > ContractScreen: Select Contract
RequestDetailScreen > ContractScreen: Click 'View Contract'
ContractScreen > FinalizeContractModal: Click 'Finalize'
FinalizeContractModal > ContractScreen: Sign/Finalize Success

// 7. Project Workspace Flows
ProjectListScreen > ProjectWorkspaceScreen: Select Project
ProjectWorkspaceScreen > KanbanBoardScreen: Click 'Kanban Tab'
ProjectWorkspaceScreen > MilestoneListScreen: Click 'Milestones Tab'
ProjectWorkspaceScreen > CurrentProgressScreen: Click 'Progress Tab'
ProjectWorkspaceScreen > CancelProjectModal: Click 'Cancel Project'

// 7.1 Kanban & Milestones
KanbanBoardScreen > SubmissionModal: Click 'Add Evidence'
MilestoneListScreen > MilestoneDetailModal: View Milestone
MilestoneDetailModal > MilestoneListScreen: Edit/Update Milestone

// 8. Subscription Flows
SubscriptionScreen > RegisterSubModal: Click 'Register New'
SubscriptionScreen > CancelSubModal: Click 'Cancel Subscription'

// 9. Dispute Flows
DisputeListScreen > CreateDisputeScreen: Click 'Create Dispute'
CreateDisputeScreen > DisputeListScreen: Submit Dispute
DisputeListScreen > DisputeInfoScreen: Select Dispute
DisputeInfoScreen > AddEvidenceModal: Click 'Add Evidence'
DisputeInfoScreen > ReportDisputeModal: Click 'Report'

// 10. Financial Flows
WalletScreen > PaymentMethodModal: Click 'Payment Method'
WalletScreen > CashoutListScreen: Click 'Cashout History'
CashoutListScreen > CashoutModal: Click 'Request Cashout'
CashoutModal > WalletScreen: Request Submitted
